# üéÆ Interactive Project - Adobe Animate Multi-Scene

Modular system to manage multiple Adobe Animate compositions as interconnected scenes in a single web application.

## üìÅ Project Structure

```
Experimento-Villa-Platzi/
‚îÇ
‚îú‚îÄ‚îÄ index.html                          # Main HTML file
‚îú‚îÄ‚îÄ README.md                           # This file
‚îú‚îÄ‚îÄ LICENSE                             # MIT License
‚îÇ
‚îú‚îÄ‚îÄ js/
‚îÇ   ‚îú‚îÄ‚îÄ main.js                         # Configuration and entry point
‚îÇ   ‚îú‚îÄ‚îÄ SceneManager.js                 # Centralized scene manager
‚îÇ   ‚îî‚îÄ‚îÄ animate-projects/               # Scripts generated by Adobe Animate
‚îÇ       ‚îú‚îÄ‚îÄ GT-Menu.js
‚îÇ       ‚îú‚îÄ‚îÄ Skyloft-menu.js
‚îÇ       ‚îî‚îÄ‚îÄ Valley-Menu.js
‚îÇ
‚îú‚îÄ‚îÄ assets/
‚îÇ   ‚îî‚îÄ‚îÄ images/                         # Composition assets
‚îÇ       ‚îú‚îÄ‚îÄ gt/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ _preloader.gif
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ granturismomenu.jpg
‚îÇ       ‚îú‚îÄ‚îÄ skyloft/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ _preloader.gif
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ Skyloft.png
‚îÇ       ‚îî‚îÄ‚îÄ valley/
‚îÇ           ‚îú‚îÄ‚îÄ _preloader.gif
‚îÇ           ‚îî‚îÄ‚îÄ Valley_Menu_atlas_1.png
‚îÇ
‚îî‚îÄ‚îÄ css/
    ‚îî‚îÄ‚îÄ (additional styles if needed)
```

## üöÄ Features

- ‚úÖ **Single HTML** - Entire application in one file
- ‚úÖ **Smooth transitions** - No page reloads, 0.5s fade in/out
- ‚úÖ **Smart lazy loading** - Scenes load only when needed
- ‚úÖ **Automatic background preloading** - After 2s, preloads all scenes
- ‚úÖ **Perfect centering** - Scenes displayed centered vertically and horizontally
- ‚úÖ **Adaptive responsive** - Scales proportionally to any screen size
- ‚úÖ **Always visible controls** - Navigation panel and info overlay permanent
- ‚úÖ **Smart preloader** - Only shows during first load of each scene
- ‚úÖ **Robust multi-scene system** - Centralized manager without global variable conflicts
- ‚úÖ **Scalable** - Adding new scenes is trivial
- ‚úÖ **Simple API** - Easy navigation between scenes
- ‚úÖ **Integrated test panel** - Styled buttons for testing

## üéØ Available Scenes

### 1. GT Menu (Gran Turismo)
- **ID**: `gt-menu`
- **Description**: Menu inspired by Gran Turismo
- **Assets**: granturismomenu.jpg

### 2. Skyloft Menu
- **ID**: `skyloft-menu`
- **Description**: Menu inspired by Skyloft (Zelda: Skyward Sword)
- **Assets**: Skyloft.png

### 3. Valley Menu
- **ID**: `valley-menu`
- **Description**: Menu inspired by Monument Valley
- **Assets**: Valley_Menu_atlas_1.png

## üèóÔ∏è Technical Architecture

### Centering and Responsive System

The project uses **Flexbox** to achieve perfect scene centering:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ    #app-container (100vw x 100vh)           ‚îÇ
‚îÇ    [position: fixed, display: flex]         ‚îÇ
‚îÇ                                             ‚îÇ
‚îÇ    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îÇ
‚îÇ    ‚îÇ   .scene-container (active)    ‚îÇ      ‚îÇ
‚îÇ    ‚îÇ   [display: flex, centered]    ‚îÇ      ‚îÇ
‚îÇ    ‚îÇ                                ‚îÇ      ‚îÇ
‚îÇ    ‚îÇ   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê       ‚îÇ      ‚îÇ
‚îÇ    ‚îÇ   ‚îÇ .animation-wrapper ‚îÇ       ‚îÇ      ‚îÇ
‚îÇ    ‚îÇ   ‚îÇ  [auto size]       ‚îÇ       ‚îÇ      ‚îÇ
‚îÇ    ‚îÇ   ‚îÇ                    ‚îÇ       ‚îÇ      ‚îÇ
‚îÇ    ‚îÇ   ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îÇ       ‚îÇ      ‚îÇ
‚îÇ    ‚îÇ   ‚îÇ  ‚îÇ  Canvas  ‚îÇ      ‚îÇ       ‚îÇ      ‚îÇ
‚îÇ    ‚îÇ   ‚îÇ  ‚îÇ (scaled) ‚îÇ      ‚îÇ       ‚îÇ      ‚îÇ
‚îÇ    ‚îÇ   ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îÇ       ‚îÇ      ‚îÇ
‚îÇ    ‚îÇ   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò       ‚îÇ      ‚îÇ
‚îÇ    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### Z-Index Hierarchy

The system uses a clear layer hierarchy:

- **Z-Index 0**: `#app-container` (scene base)
- **Z-Index 1**: `.scene-container` (individual scenes)
- **Z-Index 2**: `#test-controls`, `#info-overlay` (permanent UI)
- **Z-Index 3**: `#global-preloader` (covers everything during loading)

### Smart Preloader System

```javascript
// Only shows when a scene is NOT initialized
if (!scene.isInitialized) {
    showGlobalPreloader(`Loading ${scene.name}...`);
    await initScene(sceneId);
    hideGlobalPreloader();
}

// If scene is ALREADY loaded, immediate transition
// No preloader, no flashing, controls always visible
```

### Custom Responsive

The `SceneManager` implements its own responsive system that:

1. **Doesn't depend on global variables** (avoids conflicts between multiple scenes)
2. **Calculates optimal scale ratio** for each window size
3. **Maintains proportion** 16:9 of the canvas
4. **Centers automatically** using CSS Flexbox
5. **Supports HiDPI** (Retina displays)

```javascript
// Each scene has its own resize handler
scene.resizeHandler = () => {
    // Calculates and applies scale without polluting global scope
    const sRatio = Math.min(xRatio, yRatio);
    scene.stage.scaleX = pRatio * sRatio;
    scene.stage.scaleY = pRatio * sRatio;
};
```

## üìñ How to Use

### Starting the Project

1. Open `index.html` in a local server (recommended) or directly in the browser
2. The first scene (GT Menu) will load automatically with a preloader
3. After 2 seconds, other scenes preload in background
4. Use the control panel buttons (always visible) to navigate between scenes
5. Transitions are instantaneous after initial preload

### Navigating Between Scenes

**From test buttons (HTML):**
```javascript
// Buttons are already configured in HTML
```

**From JavaScript code:**
```javascript
// Navigate to a scene
sceneManager.goToScene('skyloft-menu');

// Or using the global function
window.navigateTo('valley-menu');
```

**From Adobe Animate (in your timeline):**
```javascript
// On a button inside Adobe Animate
this.myButton.addEventListener("click", function() {
    window.navigateTo('another-scene');
});
```

## üîß Adding New Scenes

### Step 1: Export from Adobe Animate

1. Create your project in Adobe Animate
2. Export as HTML5 Canvas
3. Copy the generated files:
   - `MyProject.js` ‚Üí `js/animate-projects/`
   - Images folder ‚Üí `assets/images/my-project/`

### Step 2: Update Paths in JS

In the file `js/animate-projects/MyProject.js`, find the `manifest` section and update the paths:

```javascript
manifest: [
    {src:"assets/images/my-project/image.jpg", id:"image"}
],
```

### Step 3: Register the Scene

In `js/main.js`, add the configuration in the `setupScenes()` function:

```javascript
sceneManager.registerScene({
    id: 'my-scene',
    name: 'My New Scene',
    scriptPath: 'js/animate-projects/MyProject.js',
    compositionId: 'THE-COMPOSITION-ID', // Copied from .js file
    className: 'TheClassName', // Copied from .js file
    manifest: [
        { src: "assets/images/my-project/image.jpg", id: "image" }
    ],
    onInit: (scene) => {
        console.log('My scene initialized');
        setupMySceneButtons(scene);
    }
});
```

### Step 4: Configure Interactions (Optional)

If you have buttons in your Adobe Animate composition:

```javascript
function setupMySceneButtons(scene) {
    const root = scene.exportRoot;
    
    if (root.myButton) {
        root.myButton.addEventListener("click", () => {
            sceneManager.goToScene('another-scene');
        });
        root.myButton.cursor = "pointer";
    }
}
```

## üé® Customization

### Change Initial Scene

In `js/main.js`, initialization line:

```javascript
await sceneManager.goToScene('my-initial-scene');
```

### Modify Transitions

In `index.html`, CSS for `.scene-container`:

```css
.scene-container {
    transition: opacity 0.5s ease-in-out; /* Modify here */
}
```

### Preload Scenes

In `js/main.js`:

```javascript
// Preload specific scenes
sceneManager.preloadScenes(['scene1', 'scene2', 'scene3']);
```

## üêõ Debugging and Troubleshooting

### System Logs

Open the browser console (F12) to see detailed logs:

- `‚úì` Marks successful operations
- `‚ùå` Marks errors
- `üîÑ` Indicates processes in progress
- `üì¶` Shows asset loading
- `‚Üí` Indicates navigation between scenes
- `üëÅÔ∏è` Shows/hides scenes
- `üì•` Indicates background preloading

### Common Issues Resolved

#### ‚ùå Error: "ReferenceError: stage is not defined"

**Cause**: Adobe Animate's `AdobeAn.makeResponsive()` function expected a global `stage` variable.

**Solution**: We implemented custom `makeSceneResponsive()` that uses local `scene.stage` for each scene.

```javascript
// ‚ùå BEFORE: Used global stage
AdobeAn.makeResponsive(true, 'both', true, 1, [canvas, container]);

// ‚úÖ NOW: Custom system without global variables
this.makeSceneResponsive(scene, lib);
```

#### ‚ö†Ô∏è Issue: Controls disappear during transitions

**Cause**: Global preloader covered entire screen on every transition.

**Solution**: 
1. Preloader only shows when a scene needs to load for the first time
2. Hierarchical z-index (preloader: 100000, controls: 10000, scenes: 1)
3. Transitions between already loaded scenes are instantaneous without preloader

```javascript
// Only shows preloader if scene is not initialized
if (!scene.isInitialized) {
    this.showGlobalPreloader(`Loading ${scene.name}...`);
    await this.initScene(sceneId);
    this.hideGlobalPreloader();
}
// If already loaded: smooth immediate transition
```

#### üé® Issue: Scenes not centered correctly

**Cause**: Using `position: absolute` with auto margins doesn't always work well.

**Solution**: Complete Flexbox system:

```css
#app-container {
    display: flex;
    justify-content: center;
    align-items: center;
}

.scene-container.active {
    display: flex;
    justify-content: center;
    align-items: center;
}
```

### Expected Behavior

‚úÖ **First load**: 
- Preloader visible ~1-2 seconds
- GT Menu loads and displays
- Controls permanently visible

‚úÖ **Navigation between scenes (first time)**:
- Preloader appears briefly
- Scene loads
- Smooth transition

‚úÖ **Navigation between scenes (already loaded)**:
- No preloader
- Instantaneous transition (0.5s fade)
- Controls always visible

‚úÖ **Automatic preloading**:
- After 2 seconds, all scenes preload
- Subsequent navigation is instantaneous

## üìä SceneManager API

### Main Methods

```javascript
// Navigate to a scene
sceneManager.goToScene(sceneId, transition = true)

// Get current scene
sceneManager.getCurrentScene()

// Get a specific scene
sceneManager.getScene(sceneId)

// Get all scenes
sceneManager.getAllScenes()

// Preload scenes
sceneManager.preloadScenes([sceneIds])

// Destroy a scene (free memory)
sceneManager.destroyScene(sceneId)
```

### Scene Callbacks

Each scene can have these callbacks:

```javascript
{
    onInit: (scene) => {}, // Executes on initialization
    onShow: (scene) => {}, // Executes on show
    onHide: (scene) => {}  // Executes on hide
}
```

## üîê Important Notes

1. **Unique IDs**: Make sure each scene has a unique ID
2. **Correct Paths**: Verify that asset paths are correct
3. **Class Names**: Class names come from the symbol in Adobe Animate library
4. **Local Server**: Some browsers require local server to load assets (use Live Server in VS Code)
5. **Global Variables**: The system does NOT pollute the global scope with stage or canvas variables
6. **Memory Management**: Event listeners are properly cleaned up when destroying scenes

## ‚ö° Implemented Optimizations

### Performance

1. **Lazy Loading**: Only loads scenes when necessary
2. **Smart Preloading**: After first scene, preloads others in background
3. **Conditional Ticker**: Only updates stage of active scenes
4. **Listener Cleanup**: Resize handlers are removed when destroying scenes

### User Experience

1. **Smooth Transitions**: 0.5s fade in/out between scenes
2. **Contextual Preloader**: Shows the name of the scene being loaded
3. **Persistent UI**: Controls and overlay always visible with high z-index
4. **Perfect Centering**: Flexbox for centering on all screen dimensions
5. **Real Responsive**: Adapts dynamically when resizing window

### Architecture

1. **Separation of Concerns**: SceneManager, main.js, index.html clearly separated
2. **No Global Variables**: Each scene is independent with its own stage
3. **Callback System**: onInit, onShow, onHide for custom logic
4. **Clean API**: Clear and documented methods

## üéØ Best Practices

### When Creating Scenes in Adobe Animate

1. **Name symbols clearly** - The name will be the `className` in code
2. **Use descriptive names for buttons** - Makes it easier to reference from JavaScript
3. **Optimize assets** - Compress images before importing
4. **Use sprite atlases** - For multiple small images (better performance)
5. **Define standard dimensions** - Recommended 1280x720 (16:9)

### When Integrating with the System

1. **Register scenes in logical order** - First scene = initial scene
2. **Implement callbacks** - For scene-specific logic
3. **Use console.log in development** - The system already has extensive logging
4. **Preload critical scenes** - Use `preloadScenes()` for important flows
5. **Clean resources** - Use `destroyScene()` to free memory if necessary

### Debugging

1. **Open DevTools (F12)** before loading the page
2. **Check the console** - All important events are logged
3. **Inspect elements** - Verify z-index and display of containers
4. **Network tab** - Confirm assets are loading correctly
5. **Performance tab** - Monitor memory and CPU usage

## üõ†Ô∏è Technologies

- **CreateJS** - Canvas animation framework
- **Adobe Animate CC** - Authoring tool
- **JavaScript ES6+** - Application logic
- **HTML5 Canvas** - Rendering

## üìù Recommended Workflow

1. **Design** your scene in Adobe Animate
2. **Export** as HTML5 Canvas
3. **Move** files to corresponding folders
4. **Update** paths in the .js file
5. **Register** the scene in main.js
6. **Test** in browser

## üéì Examples in the Project

This project includes three fully functional scenes:

1. **GT Menu** (`js/animate-projects/GT-Menu.js`)
   - Menu inspired by Gran Turismo
   - High resolution JPG image
   - Example of simple scene with single image

2. **Skyloft Menu** (`js/animate-projects/Skyloft-menu.js`)
   - Menu inspired by The Legend of Zelda: Skyward Sword
   - PNG image with transparency
   - Example of scaled scenario

3. **Valley Menu** (`js/animate-projects/Valley-Menu.js`)
   - Menu inspired by Monument Valley
   - Uses sprite sheet atlas for optimization
   - Example of texture atlas usage

### Reference Code

See `js/main.js` for:
- ‚úÖ Complete configuration of the three scenes
- ‚úÖ Custom callbacks implementation
- ‚úÖ Button setup examples (commented)
- ‚úÖ Configured preload system

See `js/SceneManager.js` for:
- ‚úÖ Complete scene manager implementation
- ‚úÖ Custom responsive system
- ‚úÖ Asset and sprite handling
- ‚úÖ Memory management and cleanup

## üöÄ Project Status

**Version**: 2.0  
**Status**: ‚úÖ Production Ready  
**Last update**: November 2024

### Recent Changes (v2.0)

- ‚úÖ Custom responsive system (no global variables)
- ‚úÖ Smart preloader (only when necessary)
- ‚úÖ Permanently visible controls
- ‚úÖ Perfect centering with Flexbox
- ‚úÖ Automatic background preloading
- ‚úÖ Optimized memory management
- ‚úÖ Documented z-index hierarchy
- ‚úÖ Extensive logging for debugging
- ‚úÖ Robust callback system

### Suggested Future Improvements

- [ ] Add customizable transitions (slide, scale, etc.)
- [ ] Implement per-scene audio system
- [ ] Add support for modal/overlay scenes
- [ ] Navigation history system (back/forward)
- [ ] State persistence between sessions
- [ ] Fullscreen mode
- [ ] Customizable themes for controls

## ü§ù Contributing

This is an experimental project designed to be extensible. Feel free to:

- üîß Modify it according to your needs
- üìö Use it as a base for your projects
- üí° Suggest improvements
- üêõ Report issues

## üìÑ License

**MIT License with Required Attribution**

Copyright (c) 2024 Mauricio Rivero

This project is licensed under the MIT License, which means:

‚úÖ **You can**:
- Use the code for personal and commercial projects
- Modify and distribute the code
- Use the code in private projects
- Sublicense and sell copies

‚ö†Ô∏è **With the condition that**:
- **You must include the original copyright notice** in all copies or substantial portions of the software
- **You must give credit to the original author** (Mauricio Rivero) in the documentation or README of your fork
- You must include a copy of this license in any distribution

‚ùå **The software is provided "AS IS"**, without warranties of any kind.

### How to Give Attribution

If you fork or use this code in your project, please include the following in your README:

```markdown
This project is based on/includes code from:
**Experimento-Villa-Platzi** by Mauricio Rivero
Original repository: [link if applicable]
License: MIT
```

### Full MIT License Text

```
MIT License

Copyright (c) 2024 Mauricio Rivero

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
```

## üôè Acknowledgments

- **CreateJS Team** - For the excellent Canvas framework
- **Adobe Animate** - For the powerful authoring tool
- **Platzi Community** - For the support and feedback

---

## üìû Contact and Support

For questions or issues:
1. Review the **Debugging and Troubleshooting** section
2. Check the browser console (F12)
3. Confirm you are using a local server

---

### Final Tips

üí° **Performance**: If working with many scenes, consider implementing a pooling system to reuse stages

üí° **Assets**: Optimize your images with tools like TinyPNG before importing them

üí° **Testing**: Test on different screen sizes and devices

üí° **Production**: Minify and bundle the code before deploying

üí° **Monitoring**: Use `sceneManager.getAllScenes()` in the console to inspect state
